# 域划分设计

在进行业务架构设计时，我们需要进行业务域的划分。能否划分出合理、稳定、可持续发展的业务域对于未来平台的发展可谓至关重要。

# 用户需求场景分析

我们经过对一个业务过程总是可以识别出有哪些人、角色会参与到业务过程的相关活动中，我们使用 UML 建模方法。一般我们会用 Use Case 图进行表达，Use Case 图会包含这些元素：

- Actor：常见的翻译包括“参与者、执行者、主角”等等。
- Use Case：在不展现一个系统或子系统内部结构的情况下，对系统或子系统的某个连贯的功能单元的定义和描述。

其中 Use Case 还会包含这些信息：名称、简单描述、关系、活动图和状态图、前置条件、后置条件等等。以一个简单的用户账号管理为例，我们绘制的整体 Use Case 图如下：

![](https://i.postimg.cc/q7chY3SD/image.png)

# 鲁棒图

鲁棒图 —— 是需求设计过程中使用的一种方法（鲁棒性分析），通过鲁棒分析法可以让设计人员更清晰、全面了解需求。它通常使用在需求分析后及需求设计前做软件架构分析之用，它主要注重于功能需求的设计分析工作。需求规格说明书为其输入信息，设计模型为其输出信息。它是从功能需求向设计方案过渡的第一步，重点是识别组成软件系统的高级职责模块、规划模块之间的关系。

鲁棒图包含三种图形：边界、控制、实体，三个图形如下：

![](https://i.postimg.cc/zB0LD1Jn/image.png)

- 边界——起与外界交互的作用，它只能与控制对象和执行者有关系
- 控制——对业务控制、流程控制的作用，它能与边界对象和实体对象有关系
- 实体——业务元素的存储对象，与领域模型中的对象有良好的关系。它只能与控制对象有关系

我们在对之前识别出的每个 Use Case，都可以绘制一份鲁棒图。通过绘制鲁棒图，我们可以定义出该场景的涉及到的边界类、控制类以及这些控制类会加工/处理哪些实体对象。我们以邮箱注册账号这个 Case 为例，我们可以简单的绘制出鲁棒图如下：

![](https://i.postimg.cc/dVrLkCsQ/image.png)

# 领域划分

接下来，我们通过对所有实体对象进行分类，就可以完成域划分了。比如，主订单、子订单对象可以归类到交易域；买家、卖家对象可以归类到会员域。

当然，最终所有的对象是归类到十个域还是二十个域，从理论上看，可以看做一次排列组合过程。只是，我们往往可以根据以往的经验、业务知识，做一个初始的域划分（但不见得是靠谱的）。因此，我们可以认为一个域实际上是一个或多个实体对象的信息集合，并对所管理的实体对象的生命周期进行管理。

- 一个域管理一个或多个实体对象
- 一个实体对象被一个域进行管理
- 如果出现一个实体对象被多个域进行管理，那么相关域的职责实际上就是存在冲突，存在耦合，相互影响。

# 域划分评估

在领域划分之后往往可以得到一个或多个域划分的方案（或者组合），接下来就是判断哪种划分方案更为合理。主要的判定原则会参照经典的“高内聚、低耦合”的原则
